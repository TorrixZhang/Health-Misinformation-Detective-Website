{"ast":null,"code":"var _jsxFileName = \"/Users/jiayue/7381-website/src/pages/UploadFile.js\";\nimport React from 'react';\nimport { Upload, message, Button, Progress } from 'antd';\nimport { UploadOutlined } from '@ant-design/icons';\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\naxios.defaults.withCredentials = true;\n\nclass UploadFile extends React.Component {\n  constructor(props) {\n    super(props);\n    this.configs = {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      },\n      withCredentials: true,\n      onUploadProgress: progress => {\n        console.log(progress);\n        let {\n          loaded\n        } = progress;\n        let {\n          filseSize\n        } = this.state;\n        console.log(loaded, filseSize);\n        let baifenbi = (loaded / filseSize * 100).toFixed(2);\n        this.setState({\n          baifenbi\n        });\n      }\n    };\n\n    this.handleUpload = () => {\n      const {\n        fileList\n      } = this.state;\n      const formData = new FormData();\n      fileList.forEach(file => {\n        formData.append('files[]', file);\n      });\n      this.setState({\n        uploading: true\n      });\n      axios.post(\"http://127.0.0.1:8000/upload\", formData, this.configs).then(res => {\n        this.setState({\n          baifenbi: 100,\n          uploading: false,\n          fileList: []\n        });\n      }).finally(log => {\n        console.log(log);\n      });\n    };\n\n    this.onchange = info => {\n      if (info.file.status !== 'uploading') {\n        this.setState({\n          filseSize: info.file.size,\n          baifenbi: 0\n        });\n      }\n\n      if (info.file.status === 'done') {\n        message.success(`${info.file.name} file uploaded successfully`);\n      } else if (info.file.status === 'error') {\n        message.error(`${info.file.name} file upload failed.`);\n      }\n    };\n\n    this.state = {\n      fileList: [],\n      uploading: false,\n      filseSize: 0,\n      baifenbi: 0\n    };\n  }\n\n  render() {\n    const {\n      uploading,\n      fileList\n    } = this.state;\n    const props = {\n      onRemove: file => {\n        this.setState(state => {\n          const index = state.fileList.indexOf(file);\n          const newFileList = state.fileList.slice();\n          newFileList.splice(index, 1);\n          return {\n            fileList: newFileList\n          };\n        });\n      },\n      beforeUpload: file => {\n        this.setState(state => ({\n          fileList: [...state.fileList, file]\n        }));\n        return false;\n      },\n      fileList\n    };\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: \"80%\",\n        margin: 'auto',\n        padding: 20\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: this.state.baifenbi + '%'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Upload, {\n        onChange: e => {\n          this.onchange(e);\n        },\n        ...props,\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          children: [/*#__PURE__*/_jsxDEV(UploadOutlined, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 13\n          }, this), \" Click to Upload\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        type: \"primary\",\n        onClick: this.handleUpload,\n        disabled: fileList.length === 0,\n        loading: uploading,\n        style: {\n          marginTop: 16\n        },\n        children: uploading ? 'Uploading' : 'Start Upload'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Progress, {\n        style: {\n          marginTop: 20\n        },\n        status: this.state.baifenbi !== 0 ? 'success' : '',\n        percent: this.state.baifenbi\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default UploadFile;","map":{"version":3,"names":["React","Upload","message","Button","Progress","UploadOutlined","axios","defaults","withCredentials","UploadFile","Component","constructor","props","configs","headers","onUploadProgress","progress","console","log","loaded","filseSize","state","baifenbi","toFixed","setState","handleUpload","fileList","formData","FormData","forEach","file","append","uploading","post","then","res","finally","onchange","info","status","size","success","name","error","render","onRemove","index","indexOf","newFileList","slice","splice","beforeUpload","width","margin","padding","e","length","marginTop"],"sources":["/Users/jiayue/7381-website/src/pages/UploadFile.js"],"sourcesContent":["import React from 'react';\nimport { Upload, message, Button, Progress } from 'antd';\nimport { UploadOutlined } from '@ant-design/icons';\n\nimport axios from \"axios\"\naxios.defaults.withCredentials = true\n\nclass UploadFile extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      fileList: [],\n      uploading: false,\n      filseSize: 0,\n      baifenbi: 0\n    }\n  }\n\n  configs = {\n    headers: { 'Content-Type': 'multipart/form-data' },\n    withCredentials: true,\n    onUploadProgress: (progress) => {\n      console.log(progress);\n      let { loaded } = progress\n      let { filseSize } = this.state\n      console.log(loaded, filseSize);\n      let baifenbi = (loaded / filseSize * 100).toFixed(2)\n      this.setState({\n        baifenbi\n      })\n    }\n  }\n\n  handleUpload = () => {\n    const { fileList } = this.state;\n    const formData = new FormData();\n    fileList.forEach(file => {\n      formData.append('files[]', file);\n    });\n    this.setState({\n      uploading: true,\n    });\n\n    axios.post(\"http://127.0.0.1:8000/upload\", formData, this.configs).then(res => {\n      this.setState({\n        baifenbi: 100,\n        uploading: false,\n        fileList: []\n      })\n    }).finally(log => {\n      console.log(log);\n    })\n  }\n  onchange = (info) => {\n    if (info.file.status !== 'uploading') {\n      this.setState({\n        filseSize: info.file.size,\n        baifenbi: 0\n      })\n    }\n    if (info.file.status === 'done') {\n      message.success(`${info.file.name} file uploaded successfully`);\n    } else if (info.file.status === 'error') {\n      message.error(`${info.file.name} file upload failed.`);\n    }\n  }\n\n\n  render() {\n    const { uploading, fileList } = this.state;\n    const props = {\n      onRemove: file => {\n        this.setState(state => {\n          const index = state.fileList.indexOf(file);\n          const newFileList = state.fileList.slice();\n          newFileList.splice(index, 1);\n          return {\n            fileList: newFileList,\n          };\n        });\n      },\n      beforeUpload: file => {\n        this.setState(state => ({\n          fileList: [...state.fileList, file],\n        }));\n        return false;\n      },\n      fileList,\n    };\n    return (\n      <div style={{ width: \"80%\", margin: 'auto', padding: 20 }}>\n        <h2>{this.state.baifenbi + '%'}</h2>\n        <Upload onChange={(e) => { this.onchange(e) }} {...props}>\n          <Button>\n            <UploadOutlined /> Click to Upload\n          </Button>\n        </Upload>\n        <Button\n          type=\"primary\"\n          onClick={this.handleUpload}\n          disabled={fileList.length === 0}\n          loading={uploading}\n          style={{ marginTop: 16 }}\n        >\n          {uploading ? 'Uploading' : 'Start Upload'}\n        </Button>\n        <Progress style={{ marginTop: 20 }} status={this.state.baifenbi !== 0 ? 'success' : ''} percent={this.state.baifenbi}></Progress>\n      </div >\n    )\n  }\n}\n\nexport default UploadFile;"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,MAAT,EAAiBC,OAAjB,EAA0BC,MAA1B,EAAkCC,QAAlC,QAAkD,MAAlD;AACA,SAASC,cAAT,QAA+B,mBAA/B;AAEA,OAAOC,KAAP,MAAkB,OAAlB;;AACAA,KAAK,CAACC,QAAN,CAAeC,eAAf,GAAiC,IAAjC;;AAEA,MAAMC,UAAN,SAAyBT,KAAK,CAACU,SAA/B,CAAyC;EACvCC,WAAW,CAACC,KAAD,EAAQ;IACjB,MAAMA,KAAN;IADiB,KAUnBC,OAVmB,GAUT;MACRC,OAAO,EAAE;QAAE,gBAAgB;MAAlB,CADD;MAERN,eAAe,EAAE,IAFT;MAGRO,gBAAgB,EAAGC,QAAD,IAAc;QAC9BC,OAAO,CAACC,GAAR,CAAYF,QAAZ;QACA,IAAI;UAAEG;QAAF,IAAaH,QAAjB;QACA,IAAI;UAAEI;QAAF,IAAgB,KAAKC,KAAzB;QACAJ,OAAO,CAACC,GAAR,CAAYC,MAAZ,EAAoBC,SAApB;QACA,IAAIE,QAAQ,GAAG,CAACH,MAAM,GAAGC,SAAT,GAAqB,GAAtB,EAA2BG,OAA3B,CAAmC,CAAnC,CAAf;QACA,KAAKC,QAAL,CAAc;UACZF;QADY,CAAd;MAGD;IAZO,CAVS;;IAAA,KAyBnBG,YAzBmB,GAyBJ,MAAM;MACnB,MAAM;QAAEC;MAAF,IAAe,KAAKL,KAA1B;MACA,MAAMM,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;MACAF,QAAQ,CAACG,OAAT,CAAiBC,IAAI,IAAI;QACvBH,QAAQ,CAACI,MAAT,CAAgB,SAAhB,EAA2BD,IAA3B;MACD,CAFD;MAGA,KAAKN,QAAL,CAAc;QACZQ,SAAS,EAAE;MADC,CAAd;MAIA1B,KAAK,CAAC2B,IAAN,CAAW,8BAAX,EAA2CN,QAA3C,EAAqD,KAAKd,OAA1D,EAAmEqB,IAAnE,CAAwEC,GAAG,IAAI;QAC7E,KAAKX,QAAL,CAAc;UACZF,QAAQ,EAAE,GADE;UAEZU,SAAS,EAAE,KAFC;UAGZN,QAAQ,EAAE;QAHE,CAAd;MAKD,CAND,EAMGU,OANH,CAMWlB,GAAG,IAAI;QAChBD,OAAO,CAACC,GAAR,CAAYA,GAAZ;MACD,CARD;IASD,CA5CkB;;IAAA,KA6CnBmB,QA7CmB,GA6CPC,IAAD,IAAU;MACnB,IAAIA,IAAI,CAACR,IAAL,CAAUS,MAAV,KAAqB,WAAzB,EAAsC;QACpC,KAAKf,QAAL,CAAc;UACZJ,SAAS,EAAEkB,IAAI,CAACR,IAAL,CAAUU,IADT;UAEZlB,QAAQ,EAAE;QAFE,CAAd;MAID;;MACD,IAAIgB,IAAI,CAACR,IAAL,CAAUS,MAAV,KAAqB,MAAzB,EAAiC;QAC/BrC,OAAO,CAACuC,OAAR,CAAiB,GAAEH,IAAI,CAACR,IAAL,CAAUY,IAAK,6BAAlC;MACD,CAFD,MAEO,IAAIJ,IAAI,CAACR,IAAL,CAAUS,MAAV,KAAqB,OAAzB,EAAkC;QACvCrC,OAAO,CAACyC,KAAR,CAAe,GAAEL,IAAI,CAACR,IAAL,CAAUY,IAAK,sBAAhC;MACD;IACF,CAzDkB;;IAEjB,KAAKrB,KAAL,GAAa;MACXK,QAAQ,EAAE,EADC;MAEXM,SAAS,EAAE,KAFA;MAGXZ,SAAS,EAAE,CAHA;MAIXE,QAAQ,EAAE;IAJC,CAAb;EAMD;;EAoDDsB,MAAM,GAAG;IACP,MAAM;MAAEZ,SAAF;MAAaN;IAAb,IAA0B,KAAKL,KAArC;IACA,MAAMT,KAAK,GAAG;MACZiC,QAAQ,EAAEf,IAAI,IAAI;QAChB,KAAKN,QAAL,CAAcH,KAAK,IAAI;UACrB,MAAMyB,KAAK,GAAGzB,KAAK,CAACK,QAAN,CAAeqB,OAAf,CAAuBjB,IAAvB,CAAd;UACA,MAAMkB,WAAW,GAAG3B,KAAK,CAACK,QAAN,CAAeuB,KAAf,EAApB;UACAD,WAAW,CAACE,MAAZ,CAAmBJ,KAAnB,EAA0B,CAA1B;UACA,OAAO;YACLpB,QAAQ,EAAEsB;UADL,CAAP;QAGD,CAPD;MAQD,CAVW;MAWZG,YAAY,EAAErB,IAAI,IAAI;QACpB,KAAKN,QAAL,CAAcH,KAAK,KAAK;UACtBK,QAAQ,EAAE,CAAC,GAAGL,KAAK,CAACK,QAAV,EAAoBI,IAApB;QADY,CAAL,CAAnB;QAGA,OAAO,KAAP;MACD,CAhBW;MAiBZJ;IAjBY,CAAd;IAmBA,oBACE;MAAK,KAAK,EAAE;QAAE0B,KAAK,EAAE,KAAT;QAAgBC,MAAM,EAAE,MAAxB;QAAgCC,OAAO,EAAE;MAAzC,CAAZ;MAAA,wBACE;QAAA,UAAK,KAAKjC,KAAL,CAAWC,QAAX,GAAsB;MAA3B;QAAA;QAAA;QAAA;MAAA,QADF,eAEE,QAAC,MAAD;QAAQ,QAAQ,EAAGiC,CAAD,IAAO;UAAE,KAAKlB,QAAL,CAAckB,CAAd;QAAkB,CAA7C;QAAA,GAAmD3C,KAAnD;QAAA,uBACE,QAAC,MAAD;UAAA,wBACE,QAAC,cAAD;YAAA;YAAA;YAAA;UAAA,QADF;QAAA;UAAA;UAAA;UAAA;QAAA;MADF;QAAA;QAAA;QAAA;MAAA,QAFF,eAOE,QAAC,MAAD;QACE,IAAI,EAAC,SADP;QAEE,OAAO,EAAE,KAAKa,YAFhB;QAGE,QAAQ,EAAEC,QAAQ,CAAC8B,MAAT,KAAoB,CAHhC;QAIE,OAAO,EAAExB,SAJX;QAKE,KAAK,EAAE;UAAEyB,SAAS,EAAE;QAAb,CALT;QAAA,UAOGzB,SAAS,GAAG,WAAH,GAAiB;MAP7B;QAAA;QAAA;QAAA;MAAA,QAPF,eAgBE,QAAC,QAAD;QAAU,KAAK,EAAE;UAAEyB,SAAS,EAAE;QAAb,CAAjB;QAAoC,MAAM,EAAE,KAAKpC,KAAL,CAAWC,QAAX,KAAwB,CAAxB,GAA4B,SAA5B,GAAwC,EAApF;QAAwF,OAAO,EAAE,KAAKD,KAAL,CAAWC;MAA5G;QAAA;QAAA;QAAA;MAAA,QAhBF;IAAA;MAAA;MAAA;MAAA;IAAA,QADF;EAoBD;;AAtGsC;;AAyGzC,eAAeb,UAAf"},"metadata":{},"sourceType":"module"}